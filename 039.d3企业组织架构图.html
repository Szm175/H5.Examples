<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <script src="https://d3js.org/d3.v7.min.js"></script>
</head>

<body>

    <div class="company-info">
        <div class="company-info-tree" id="app">
            <div id="company-info-tree-root"></div>
        </div>
    </div>

    <script type="module">
        // 封装请求
        function get(url) {
            return {
                then: (resove, reject) => {
                    try {
                        let xhr = new XMLHttpRequest();
                        xhr.open('GET', url)
                        xhr.onload = () => {
                            resove(JSON.parse(xhr.responseText))
                        }
                        xhr.send()
                    } catch (error) {
                        resove(error)
                    }
                }
            }
        }
        // 获取组织架构数据
        const companyInfoTree = await get('./assets/companyInfoTree.json')
        const companyName = companyInfoTree.data.rootName;


        const fontSize = 14 // 字体大小，也是单字所占宽高

        let centralY = 0
        let centralX = 0
        let rootNodeWidth = 0 // 根节点字符所占宽度
        let rootId = '#company-info-tree-root'
        let svg
        let container
        // d3 初始化
        function init() {

            const margin = { top: 50, right: 20, bottom: -20, left: 0 };
            const treeWidth = d3.select(rootId)._parents[0].clientWidth;
            const treeHeight = d3.select(rootId)._parents[0].clientHeight;
            centralY = treeWidth / 2 + margin.left;
            centralX = treeHeight / 2 + margin.top;
            rootNodeWidth = companyName.length * fontSize + 50;
            //svg标签
            svg = d3
                .select(rootId)
                .append("svg")
                .attr("class", "tree-svg")
                .attr("xmlns", "http://www.w3.org/2000/svg")
                .attr("width", treeWidth)
                .attr("height", treeHeight)
                .attr("font-size", fontSize)
                .attr("fill", "#555");

            container = svg
                .append("g")
                .attr("class", "container1")
                .attr(
                    "transform",
                    "translate(" + margin.left + "," + margin.top + ") scale(0.8)"
                );

            draw()
        }
        // d3 绘制
        function draw() {

        }
        console.log(d3);

    </script>
</body>

</html>